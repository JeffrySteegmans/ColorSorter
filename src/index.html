<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Image color sort POC</title>

  <style>
    .matrix {
      margin: 10px 0;
      padding: 0;
      display: grid;
    }

    .matrix > li {
      list-style-type: none;
    }

    .bold {
      font-weight: bold;
    }
  </style>

  <script src="sortHelpers.js"></script>
  <script src="bubbleSort.js"></script>
  <script src="insertionSort.js"></script>
  <script src="selectionSort.js"></script>
  <script src="tinycolor.js"></script>
  <script>
    let colors = [];
    let matrixWidth = 360;

    function GetColorList(count){
      let colors = [];
      for (let i = 0; i < count; i++){
        colors.push(tinycolor.random());
      }
      return colors;
    }

    function GenerateColorMatrix(gridSize) {
      let colorList = document.getElementById('colors');
      colorList.innerHTML = "";
      let gridTemplateColumns = "";

      for (let i = 0; i < gridSize; i++) {
        gridTemplateColumns += '1fr ';
      }

      let matrix = document.createElement('ul');
      matrix.className = "matrix";
      matrix.setAttribute('style', 'grid-template-columns: ' + gridTemplateColumns + ';width:' + matrixWidth + 'px;');

      colors = GetColorList(gridSize*gridSize);
      let pixelSize = matrixWidth/gridSize;
      for (let color of colors){
        let listItem = document.createElement('li');
        listItem.setAttribute('style', 'background-color:' + color.toHslString() + '; width: ' + pixelSize + 'px; height: ' + pixelSize + 'px;');
        matrix.append(listItem);
      }

      colorList.append(matrix);
    }

    function RenderSortedMatrix(array){
      let colorList = document.getElementById('colorsSorted');
      colorList.innerHTML = "";
      let gridTemplateColumns = "";
      let gridSize = parseInt(document.getElementById('colorCount').value);

      for (let i = 0; i < gridSize; i++) {
        gridTemplateColumns += '1fr ';
      }

      let matrix = document.createElement('ul');
      matrix.className = "matrix";
      matrix.setAttribute('style', 'grid-template-columns: ' + gridTemplateColumns + ';width:' + matrixWidth + 'px;');

      for (let color of array){
        let listItem = document.createElement('li');
        let pixelSize = matrixWidth/gridSize;
        listItem.setAttribute('style', 'background-color:' + color.toHslString() + '; width: ' + pixelSize + 'px; height: ' + pixelSize + 'px;');
        matrix.append(listItem);
      }

      colorList.append(matrix);
    }

    window.addEventListener('load', () => {
      document.getElementById('convert').addEventListener('click',  (e) => {
        let inputColor = document.getElementById('inputColor').value;
        let color = tinycolor(inputColor);
        document.getElementById('result').innerHTML = color.toHslString();
      });

      GenerateColorMatrix(parseInt(document.getElementById('colorCount').value));
      document.getElementById('regeneratecolors').addEventListener('click', (e) => {
        let size = parseInt(document.getElementById('colorCount').value);
        GenerateColorMatrix(size);
      });
      document.getElementById('algorithm').addEventListener('change', (e) => {
        GenerateColorMatrix(parseInt(document.getElementById('colorCount').value));
      });

      document.getElementById('sortColors').addEventListener('click', (e) => {
        let colorList = document.getElementById('colorsSorted');
        colorList.innerHTML = 'Sorting...';

        let sorted = [];
        let algorithm = document.getElementById('algorithm').value;
        let selectedAlgorithm = document.getElementById('selectedAlgorithm');

        let t0, t1;
        switch(algorithm){
          case 'bubblesort':
            selectedAlgorithm.innerHTML = 'Bubble sort';
            t0 = performance.now();
            sorted = BubbleSort(colors);
            t1 = performance.now();
            break;
          case 'insertionsort':
            selectedAlgorithm.innerHTML = 'Insertion sort';
            t0 = performance.now();
            sorted = BubbleSort(colors);
            t1 = performance.now();
            break;
          case 'selectionsort':
            selectedAlgorithm.innerHTML = 'Selection sort';
            t0 = performance.now();
            sorted = SelectionSort(colors);
            t1 = performance.now();
            break;
        }

        let elapsedTime = Math.round(t1 - t0);
        let unit = ' milliseconds';
        if (elapsedTime > 1000){
          elapsedTime = Math.round(elapsedTime / 10) / 100;
          unit = ' seconds';
        }
        document.getElementById('elapsedTime').innerHTML =  elapsedTime + unit;
        RenderSortedMatrix(colors);
      });
    });
  </script>
</head>
<body>
  <h2>Array of colors:</h2>
  <div>
    <label>
      Grid size:
      <input type="number" min="10" max="360" s tep="1" id="colorCount" value="25" />
    </label>
    <button id="regeneratecolors">Generate colors</button>
  </div>
  <div>
    <label>
      Sorting algorithm:
      <select id="algorithm">
        <option value="bubblesort">Bubble sort</option>
        <option value="insertionsort">Insertion sort</option>
        <option value="selectionsort">Selection sort</option>
      </select>
    </label>
    <button id="sortColors">Sort</button>
  </div>
  <section id="colors"></section>
  <h2>Sorted</h2>
  <p>
    Sorting algorithm: <span id="selectedAlgorithm" class="bold"></span><br />
    Sorted in: <span id="elapsedTime" class="bold"></span>
  </p>
  <section id="colorsSorted"></section>
  <hr/>
  <h2>Convert color:</h2>
  <label>
    Color:
    <input type="color" id="inputColor" value="#157269" />
  </label>
  <input type="button" value="Convert to HSL" id="convert" />
  <p>Converted value = <span id="result"></span></p>
</body>
</html>